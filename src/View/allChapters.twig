{% extends 'layout/layout.twig' %}

{% block subtitle %}Chapitre et commentaires {% endblock %}

{% block description %}Voici l'intégralité du chapitre et les commentaires associés.{% endblock %}

{% block main %}
    <main class="white">
        <section class="introduction">
                <h1>Billet pour l'Alaska</h1>
            <p>Voici le chapitre {{ billet.id }}.</p>
        </section>

        <div class="admin_update">
            <section class="premier_billet">
                    <h2>
                        {{ billet.titre }}
                    </h2>
                    <p>
                        {{ billet.contenu }}
                    </p>
                {% if session == true %}
                {% if admin == 1 %}
                    <a href="{{ url('articles!update', {'id': billet.id}) }}">Modifier</a>
                    <a href="{{ url("articles!delete", {'id': billet.id}) }}">Supprimer</a>
                {% endif %}
                {% endif %}
            </section>
        </div>

        <div class="admin_update">
        <section class="tous_commentaires">
                <section class="chp_1">
                    <h2>Commentaires du chapitre {{ billet.id }}</h2>
                    {% for comment in comments %}
                        <section class="commentaires">
                            <p>Écrit par : <span>{{ comment.auteur }}</span> :</p>
                            <p>{{ comment.contenu | nl2br}}</p>
                            <p>le <span>{{ comment.date_commentaire }} :</span></p>
                            <a class="signal" href="{{ url("comments!report", {'id_comment': comment.id}, {'id_billet': comment.id_billet}) }}">Signaler le commentaire</a>

                            {% if session == true %}
                            {% if admin == 1 %}
                            <a href="{{ url("comments!delete", {'id_comment': comment.id}) }}">Supprimer le commentaire</a>
                            {% endif %}
                            {% endif %}
                        </section>
                    {% endfor %}
                </section>
        </section>

            {% if comments == false %}
            <section class="tous_commentaires chp_1">
                <section class="commentaires">
                    <p>Il n'y a pas de commentaires pour le moment. Soyez le premier à en ajouter un !</p>
                </section>
            </section>
            {% endif %}

        </div>
        <section class="add_comment">
            <h2>Ajouter un commentaire</h2>
            <form  method="post" action="{{ url("comments!create", {'id': billet.id}) }}">
                <input name="pseudo" type="text" placeholder="pseudo" required>
                <textarea name="content" rows="5" placeholder="Contenu du commentaire" required></textarea>
                <input name="date" type="hidden" value="{{ date()|date('Y-m-d H:i:s') }}">

                <div>
                    <a href="{{ url('articles') }}">Quitter</a>
                    <input type="reset" value="Effacer">
                    <input type="submit" value="Commenter">
                </div>
            </form>
        </section>

    </main>
{% endblock %}